<% if @bookings.present? %>
  <h1>Your Bookings</h1>

  <table class="table" data-controller="bookings">
    <thead>
      <tr>
        <th>User</th>
        <th>Vehicle Name</th>
        <th>Vehicle Owner Name</th>
        <th>Vehicle Registration No.</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th>Start Time</th>
        <th>End Time</th>
        <th>Price per hour</th>
        <th>Total Amount</th>
        <th>Status</th>
        <th colspan="3">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @bookings.each do |booking| %>
        <tr>
          <td><%= booking.user.name %></td>
          <td><%= booking.vehicle.name %></td>
          <td><%= booking.vehicle.owner&.name %></td>
          <td><%= booking.vehicle.registration_number %></td>
          <td><%= booking.start_date %></td>
          <td><%= booking.end_date %></td>
          <td><%= booking.start_time.strftime("%H:%M %p") %></td>
          <td><%= booking.end_time.strftime("%H:%M %p") %></td>
          <td><%= number_to_currency(booking.vehicle.price_per_hour, unit: "Rs. ") %></td>
          <td><%= number_to_currency(booking.calculate_total_amount, unit: "Rs. ") %></td>
          <td>
            <% status_class = case booking.status
                              when 'pending'
                                'badge text-bg-warning'
                              when 'accepted'
                                'badge text-bg-success'
                              when 'rejected'
                                'badge text-bg-danger'
                              else
                                ''
                              end %>
            <span class="<%= status_class %>" data-booking-id="<%= booking.id %>" data-bookings-target="status">
              <%= booking.status.present? ? booking.status.capitalize : 'Pending' %>
            </span>
          </td>
          <td>
            <%= link_to booking_path(booking) do %>
              <i class="bi bi-eye me-2"></i>
            <% end %>
            <%= link_to edit_booking_path(booking) do %>
              <i class="bi bi-pencil-fill me-2"></i>
            <% end %>
            <%= link_to booking_path(booking), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } do %>
              <i class="bi bi-trash"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p class="fs-4">No bookings done by you.</p>
<% end %>
